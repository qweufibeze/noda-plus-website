function initThemeToggle(){const e=document.getElementById("theme-toggle"),t=document.documentElement,o=localStorage.getItem("theme"),r=window.matchMedia("(prefers-color-scheme: dark)").matches;"light"===o?t.setAttribute("data-theme","light"):"dark"===o?t.removeAttribute("data-theme"):r||t.setAttribute("data-theme","light"),e&&e.addEventListener("click",()=>{const o="light"===t.getAttribute("data-theme")?"dark":"light";"dark"===o?t.removeAttribute("data-theme"):t.setAttribute("data-theme",o),localStorage.setItem("theme",o),gsap.to(e,{scale:.95,duration:.1,yoyo:!0,repeat:1})}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")||(e.matches?t.removeAttribute("data-theme"):t.setAttribute("data-theme","light"))})}function initPreloader(){const e=document.getElementById("preloader");window.addEventListener("load",()=>{setTimeout(()=>{e.classList.add("hidden"),document.body.classList.remove("loading"),animateHeroEntrance()},1800)})}function initCustomCursor(){const e=document.getElementById("cursor"),t=document.getElementById("cursor-follower");if(!e||!t)return;if("ontouchstart"in window)return;let o=0,r=0,n=0,a=0,i=0,s=0;document.addEventListener("mousemove",n=>{o=n.clientX,r=n.clientY,e.classList.add("visible"),t.classList.add("visible")}),function c(){n+=.5*(o-n),a+=.5*(r-a),i+=.15*(o-i),s+=.15*(r-s),e.style.transform=`translate(${n-4}px, ${a-4}px)`,t.style.transform=`translate(${i-20}px, ${s-20}px)`,requestAnimationFrame(c)}();document.querySelectorAll("a, button, .service-card, .portfolio-item, .tech-item").forEach(e=>{e.addEventListener("mouseenter",()=>{t.classList.add("hover")}),e.addEventListener("mouseleave",()=>{t.classList.remove("hover")})}),document.addEventListener("mouseleave",()=>{e.classList.remove("visible"),t.classList.remove("visible")})}function initHeader(){const e=document.getElementById("header");let t=0;window.addEventListener("scroll",()=>{const o=window.pageYOffset;o>50?e.classList.add("scrolled"):e.classList.remove("scrolled"),t=o})}function initMobileMenu(){const e=document.getElementById("burger"),t=document.getElementById("mobile-menu"),o=document.querySelectorAll(".mobile-nav-link");e&&t&&(e.addEventListener("click",()=>{e.classList.toggle("active"),t.classList.toggle("active"),document.body.classList.toggle("menu-open")}),o.forEach(o=>{o.addEventListener("click",()=>{e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("menu-open")})}))}function initHeroAnimations(){createParticles()}function animateHeroEntrance(){gsap.timeline().from(".hero-badge",{opacity:0,y:20,duration:.6,ease:"power3.out"}).from(".title-line",{opacity:0,y:40,duration:.8,stagger:.15,ease:"power3.out"},"-=0.3").from(".hero-subtitle",{opacity:0,y:20,duration:.6,ease:"power3.out"},"-=0.4").from(".hero-actions .btn",{opacity:0,y:20,duration:.5,stagger:.1,ease:"power3.out"},"-=0.3").from(".stat-item",{opacity:0,y:20,duration:.5,stagger:.1,ease:"power3.out"},"-=0.3").from(".hero-phone",{opacity:0,scale:.9,duration:1,ease:"power3.out"},"-=0.8").from(".float-card",{opacity:0,scale:.8,duration:.6,stagger:.15,ease:"back.out(1.7)"},"-=0.5").from(".scroll-indicator",{opacity:0,y:20,duration:.5,ease:"power3.out"},"-=0.3")}function createParticles(){const e=document.getElementById("particles");if(!e)return;for(let t=0;t<50;t++){const t=document.createElement("div");t.className="particle",t.style.cssText=`\n            position: absolute;\n            width: ${4*Math.random()+1}px;\n            height: ${4*Math.random()+1}px;\n            background: rgba(139, 92, 246, ${.5*Math.random()+.2});\n            border-radius: 50%;\n            left: ${100*Math.random()}%;\n            top: ${100*Math.random()}%;\n            pointer-events: none;\n        `,e.appendChild(t),gsap.to(t,{y:100*Math.random()-50,x:100*Math.random()-50,opacity:.5*Math.random(),duration:5*Math.random()+5,repeat:-1,yoyo:!0,ease:"sine.inOut"})}}function initScrollAnimations(){gsap.utils.toArray(".section-header").forEach(e=>{gsap.from(e.children,{scrollTrigger:{trigger:e,start:"top 80%",once:!0},opacity:0,y:40,duration:.8,stagger:.15,ease:"power3.out"})}),gsap.from(".about-content",{scrollTrigger:{trigger:".about-grid",start:"top 70%",once:!0},opacity:0,x:-50,duration:1,ease:"power3.out"}),gsap.from(".about-visual",{scrollTrigger:{trigger:".about-grid",start:"top 70%",once:!0},opacity:0,x:50,duration:1,ease:"power3.out"}),gsap.fromTo(".feature-item",{opacity:0,x:-30},{scrollTrigger:{trigger:".about-features",start:"top 80%",once:!0},opacity:1,x:0,duration:.6,stagger:.15,ease:"power3.out",clearProps:"all"}),gsap.fromTo(".service-card",{opacity:0,y:60},{scrollTrigger:{trigger:".services-grid",start:"top 70%",once:!0},opacity:1,y:0,duration:.8,stagger:{amount:.6,from:"start"},ease:"power3.out",clearProps:"all"}),gsap.fromTo(".tech-panel.active .tech-item",{opacity:0,scale:.8},{scrollTrigger:{trigger:".tech-content",start:"top 80%",once:!0},opacity:1,scale:1,duration:.5,stagger:{amount:.5,from:"center"},ease:"back.out(1.7)",clearProps:"all"}),gsap.from(".portfolio-item",{scrollTrigger:{trigger:".portfolio-grid",start:"top 70%",toggleActions:"play none none reverse"},opacity:0,y:60,duration:.8,stagger:.15,ease:"power3.out"}),initProcessTimeline(),gsap.from(".contact-info",{scrollTrigger:{trigger:".contact-wrapper",start:"top 70%",toggleActions:"play none none reverse"},opacity:0,x:-50,duration:.8,ease:"power3.out"}),gsap.from(".contact-form-wrapper",{scrollTrigger:{trigger:".contact-wrapper",start:"top 70%",toggleActions:"play none none reverse"},opacity:0,x:50,duration:.8,ease:"power3.out"})}function initTechTabs(){const e=document.querySelectorAll(".tech-tab"),t=document.querySelectorAll(".tech-panel");e.forEach(o=>{o.addEventListener("click",()=>{const r=o.dataset.tab;e.forEach(e=>e.classList.remove("active")),t.forEach(e=>e.classList.remove("active")),o.classList.add("active"),document.querySelector(`[data-panel="${r}"]`).classList.add("active"),gsap.fromTo(`[data-panel="${r}"] .tech-item`,{opacity:0,scale:.8},{opacity:1,scale:1,duration:.4,stagger:{amount:.3,from:"center"},ease:"back.out(1.7)",clearProps:"all"})})})}function initReviewsSlider(){const e=document.getElementById("reviews-track"),t=document.querySelectorAll(".review-card"),o=document.getElementById("slider-prev"),r=document.getElementById("slider-next"),n=document.getElementById("slider-dots");if(!e||!t.length)return;let a=0;const i=t.length-(window.innerWidth>768?2:1);for(let e=0;e<=i;e++){const t=document.createElement("div");t.className="slider-dot "+(0===e?"active":""),t.addEventListener("click",()=>c(e)),n.appendChild(t)}const s=n.querySelectorAll(".slider-dot");function c(o){a=Math.max(0,Math.min(o,i));const r=t[0].offsetWidth+parseInt(getComputedStyle(e).gap);gsap.to(e,{x:-a*r,duration:.5,ease:"power3.out"}),s.forEach((e,t)=>{e.classList.toggle("active",t===a)})}o.addEventListener("click",()=>c(a-1)),r.addEventListener("click",()=>c(a+1));let l=setInterval(()=>{c(a>=i?0:a+1)},5e3);e.addEventListener("mouseenter",()=>clearInterval(l)),e.addEventListener("mouseleave",()=>{l=setInterval(()=>{c(a>=i?0:a+1)},5e3)}),window.addEventListener("resize",()=>{c(0)})}function initContactForm(){const e=document.getElementById("contact-form");if(!e)return;e.querySelectorAll(".form-input, .form-select, .form-textarea").forEach(e=>{e.addEventListener("focus",()=>{gsap.to(e,{scale:1.02,duration:.2,ease:"power2.out"})}),e.addEventListener("blur",()=>{gsap.to(e,{scale:1,duration:.2,ease:"power2.out"})})});const t=document.getElementById("phone");t&&(t.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"");0===t.length?t="7":"7"!==t[0]&&(t="7"+t);let o="+7 (";t.length>1&&(o+=t.substring(1,4)),t.length>=4&&(o+=") "+t.substring(4,7)),t.length>=7&&(o+="-"+t.substring(7,9)),t.length>=9&&(o+="-"+t.substring(9,11)),e.target.value=o}),t.addEventListener("focus",()=>{""===t.value&&(t.value="+7 (")}),t.addEventListener("keydown",e=>{"Backspace"===e.key&&t.value.length<=4&&e.preventDefault()})),e.addEventListener("submit",()=>{const t=e.querySelector(".form-submit");t.innerHTML='\n            <span>Отправка...</span>\n            <svg class="btn-icon" style="animation: spin 1s linear infinite" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                <path d="M21 12a9 9 0 11-6.219-8.56"/>\n            </svg>\n        ',t.disabled=!0})}document.addEventListener("DOMContentLoaded",()=>{gsap.registerPlugin(ScrollTrigger),initThemeToggle(),initPreloader(),initCustomCursor(),initHeader(),initMobileMenu(),initHeroAnimations(),initScrollAnimations(),initTechTabs(),initReviewsSlider(),initContactForm(),initSmoothScroll(),initParallax(),initCounterAnimation()});const style=document.createElement("style");function initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{const o=e.getAttribute("href");if("#"===o)return;t.preventDefault();const r=document.querySelector(o);if(r){const e=document.getElementById("header").offsetHeight,t=r.getBoundingClientRect().top+window.pageYOffset-e;gsap.to(window,{scrollTo:t,duration:.5,ease:"power2.out"})}})})}function initParallax(){gsap.to(".hero-gradient",{scrollTrigger:{trigger:".hero",start:"top top",end:"bottom top",scrub:1},y:200,opacity:.5}),gsap.to(".hero-phone",{scrollTrigger:{trigger:".hero",start:"top top",end:"bottom top",scrub:1},y:100}),gsap.to(".float-card-1",{scrollTrigger:{trigger:".hero",start:"top top",end:"bottom top",scrub:1},y:50}),gsap.to(".float-card-2",{scrollTrigger:{trigger:".hero",start:"top top",end:"bottom top",scrub:1},y:80}),gsap.to(".float-card-3",{scrollTrigger:{trigger:".hero",start:"top top",end:"bottom top",scrub:1},y:60})}function initCounterAnimation(){document.querySelectorAll(".stat-number").forEach(e=>{const t=parseInt(e.dataset.count);ScrollTrigger.create({trigger:e,start:"top 80%",onEnter:()=>{gsap.to(e,{innerHTML:t,duration:2,snap:{innerHTML:1},ease:"power2.out"})},once:!0})})}function debounce(e,t){let o;return function(...r){clearTimeout(o),o=setTimeout(()=>{clearTimeout(o),e(...r)},t)}}style.textContent="\n    @keyframes spin {\n        from { transform: rotate(0deg); }\n        to { transform: rotate(360deg); }\n    }\n",document.head.appendChild(style),document.querySelectorAll(".service-card").forEach(e=>{e.addEventListener("mousemove",t=>{const o=e.getBoundingClientRect(),r=t.clientX-o.left-o.width/2,n=t.clientY-o.top-o.height/2;gsap.to(e,{rotateX:-n/20,rotateY:r/20,duration:.3,ease:"power2.out",transformPerspective:1e3})}),e.addEventListener("mouseleave",()=>{gsap.to(e,{rotateX:0,rotateY:0,duration:.5,ease:"power2.out"})})}),document.querySelectorAll(".portfolio-item").forEach(e=>{e.addEventListener("mouseenter",()=>{gsap.to(e.querySelector(".portfolio-placeholder"),{scale:1.05,duration:.5,ease:"power2.out"})}),e.addEventListener("mouseleave",()=>{gsap.to(e.querySelector(".portfolio-placeholder"),{scale:1,duration:.5,ease:"power2.out"})})}),document.querySelectorAll(".btn").forEach(e=>{e.addEventListener("click",t=>{const o=e.getBoundingClientRect(),r=t.clientX-o.left,n=t.clientY-o.top,a=document.createElement("span");a.style.cssText=`\n            position: absolute;\n            width: 0;\n            height: 0;\n            border-radius: 50%;\n            background: rgba(255, 255, 255, 0.3);\n            transform: translate(-50%, -50%);\n            left: ${r}px;\n            top: ${n}px;\n            pointer-events: none;\n        `,e.style.position="relative",e.style.overflow="hidden",e.appendChild(a),gsap.to(a,{width:300,height:300,opacity:0,duration:.6,ease:"power2.out",onComplete:()=>a.remove()})})}),window.addEventListener("resize",debounce(()=>{ScrollTrigger.refresh()},250)),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(gsap.globalTimeline.timeScale(0),ScrollTrigger.getAll().forEach(e=>e.kill())),document.addEventListener("keydown",e=>{"ArrowLeft"===e.key&&document.getElementById("slider-prev")?.click(),"ArrowRight"===e.key&&document.getElementById("slider-next")?.click()}),document.addEventListener("keydown",e=>{"Tab"===e.key&&document.body.classList.add("keyboard-nav")}),document.addEventListener("mousedown",()=>{document.body.classList.remove("keyboard-nav")});const keyboardStyles=document.createElement("style");function initProcessTimeline(){const e=document.getElementById("process-timeline"),t=document.querySelector(".timeline-line-progress"),o=document.querySelectorAll(".process-step");!e||!o.length||window.innerWidth<=768||(ScrollTrigger.create({trigger:e,start:"top 40%",end:"bottom 60%",onUpdate:e=>{const o=e.progress;t&&(t.style.height=100*o+"%")}}),o.forEach((e,t)=>{ScrollTrigger.create({trigger:e,start:"top 55%",end:"bottom 45%",onEnter:()=>e.classList.add("active"),onLeave:()=>{t<o.length-1&&e.classList.add("active")},onEnterBack:()=>e.classList.add("active"),onLeaveBack:()=>{t>0&&e.classList.remove("active")}})}))}keyboardStyles.textContent="\n    .keyboard-nav *:focus {\n        outline: 2px solid var(--color-accent-primary) !important;\n        outline-offset: 2px !important;\n    }\n",document.head.appendChild(keyboardStyles);